# TAMA2 多语言功能使用说明

## 概述

TAMA2 应用现已支持多语言功能，目前支持以下语言：
- **英语 (English)** - 默认语言
- **繁体中文 (繁體中文)** - 台湾地区用户习惯

## 功能特性

### 1. 自动语言检测
- 应用启动时自动检测系统语言
- 如果系统语言不在支持列表中，默认使用英语

### 2. 实时语言切换
- 用户可以在登录和注册页面右上角看到语言选择器图标 🌐
- 点击图标可以随时切换语言，无需重启应用
- 语言选择会被保存到本地存储，下次启动时自动应用

### 3. 完整的界面本地化
- 登录页面：标题、表单标签、验证消息、按钮文本
- 注册页面：标题、表单标签、验证消息、按钮文本
- 错误提示和成功消息

## 使用方法

### 切换语言
1. 在登录或注册页面右上角找到语言图标 🌐
2. 点击图标打开语言选择菜单
3. 选择你喜欢的语言
4. 界面会立即切换到所选语言

### 支持的语言

| 语言代码 | 语言名称 | 本地名称 | 说明 |
|---------|---------|---------|------|
| `en` | English | English | 默认语言，完整支持 |
| `zh_TW` | Traditional Chinese | 繁體中文 | 台湾地区用户习惯，完整支持 |

## 技术实现

### 1. 依赖包
- `flutter_i18n: ^0.36.3` - 核心国际化包
- `flutter_localizations` - Flutter 官方本地化支持

### 2. 文件结构
```
assets/
  flutter_i18n/
    en.json          # 英语语言文件
    zh_TW.json       # 繁体中文语言文件
```

### 3. 核心组件
- `LanguageService` - 语言管理服务
- `LanguageSelector` - 语言选择器组件
- 集成到 `main.dart` 的国际化配置

### 4. 语言文件格式
使用 JSON 格式组织翻译键值对：
```json
{
  "auth": {
    "login": {
      "title": "Welcome Back",
      "subtitle": "Sign in to continue your journey"
    }
  }
}
```

## 添加新语言

### 1. 创建语言文件
在 `assets/flutter_i18n/` 目录下创建新的语言文件，例如 `ja.json`（日语）。

### 2. 更新语言服务
在 `lib/shared/services/language_service.dart` 中添加新语言：
```dart
static const List<Map<String, String>> supportedLanguages = [
  {'code': 'en', 'name': 'English', 'nativeName': 'English'},
  {'code': 'zh_TW', 'name': 'Traditional Chinese', 'nativeName': '繁體中文'},
  {'code': 'ja', 'name': 'Japanese', 'nativeName': '日本語'}, // 新增
];
```

### 3. 更新主应用配置
在 `lib/main.dart` 中添加新语言支持：
```dart
supportedLocales: const [
  Locale('en'),      // English
  Locale('zh', 'TW'), // Traditional Chinese (Taiwan)
  Locale('ja'),      // Japanese (新增)
],
```

### 4. 更新 pubspec.yaml
确保新语言文件被包含在资源中：
```yaml
flutter:
  assets:
    - assets/flutter_i18n/
```

## 最佳实践

### 1. 翻译键命名
- 使用点分隔的层次结构：`auth.login.title`
- 保持键名简洁明了
- 避免过深的嵌套

### 2. 文本长度考虑
- 不同语言的文本长度可能差异很大
- 设计 UI 时要考虑最长的文本
- 使用 `Flexible` 或 `Expanded` 包装文本组件

### 3. 文化适应性
- 考虑不同文化的用户习惯
- 适当调整日期、数字等格式
- 注意颜色和图标的文化含义

## 故障排除

### 常见问题

1. **语言切换后界面没有更新**
   - 检查是否正确调用了 `FlutterI18n.refresh()`
   - 确保语言文件路径正确

2. **某些文本没有翻译**
   - 检查语言文件中是否包含对应的翻译键
   - 使用 `missingTranslationHandler` 调试缺失的键

3. **应用启动时语言不正确**
   - 检查 `LanguageService.getCurrentLanguage()` 的返回值
   - 确认本地存储中的语言设置

### 调试技巧

1. 启用详细日志：
```dart
missingTranslationHandler: (key, locale) {
  debugPrint("--- Missing Key: $key, languageCode: ${locale?.languageCode}");
},
```

2. 检查语言文件加载：
```dart
final currentLocale = FlutterI18n.currentLocale(context);
debugPrint("Current locale: $currentLocale");
```

## 更新日志

- **v1.0.0** - 初始版本，支持英语和繁体中文
- 完整的登录和注册页面本地化
- 实时语言切换功能
- 本地语言偏好保存

## 贡献指南

欢迎为多语言功能做出贡献！

1. Fork 项目
2. 创建功能分支
3. 添加新语言或改进现有翻译
4. 提交 Pull Request

## 联系方式

如有问题或建议，请通过以下方式联系：
- 项目 Issues
- 开发团队邮箱
- 技术支持文档
