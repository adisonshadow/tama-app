# Tama2 移动APP开发清单

## 项目概述
基于现有Tama2项目的前后台架构，使用Flutter开发移动端应用。参考抖音风格的UI设计和交互体验。

## 技术架构
- **前端**: Flutter
- **后端**: 复用现有API服务 (端口: 3003)
- **认证**: JWT Token
- **网络**: HTTP/HTTPS API调用

## 现有API接口分析

### 认证相关
- `POST /api/auth/register` - 用户注册
- `POST /api/auth/login` - 用户登录
- `GET /api/auth/current` - 获取当前用户信息
- `POST /api/auth/refresh` - 刷新token
- `POST /api/auth/logout` - 用户登出

### 文章/视频相关
- `GET /api/articles/recommended2` - 获取推荐文章(首页内容)
- `GET /api/articles/hot` - 获取热门内容
- `GET /api/articles/short` - 获取短视频内容
- `GET /api/articles/{id}` - 获取文章详情
- `GET /api/articles/{id}/danmaku` - 获取弹幕

### 用户相关
- `GET /api/user/getUserInfoById/{user_id}` - 根据ID获取用户信息
- `GET /api/my/getMyLatestArticles` - 获取我的文章
- `GET /api/my/getMyFollows` - 获取我的关注
- `POST /api/my/follow` - 关注用户
- `DELETE /api/my/unfollow` - 取消关注

### 文件上传
- `POST /api/upload/image` - 上传图片
- `POST /api/upload/video` - 上传视频

## 开发阶段规划

### 第一阶段：项目初始化和基础框架
- [x] ~~创建开发清单~~
- [ ] 初始化Flutter项目
- [ ] 配置项目依赖
- [ ] 设置网络请求库(dio)
- [ ] 设置状态管理(Provider/Riverpod)
- [ ] 配置路由系统
- [ ] 设计基础UI组件库

### 第二阶段：核心功能实现
- [ ] **登录/注册模块**
  - [ ] 登录页面UI
  - [ ] 注册页面UI
  - [ ] JWT Token管理
  - [ ] 自动登录逻辑
  - [ ] 登出功能

- [ ] **推荐页面(首页)**
  - [ ] 视频列表UI (抖音风格)
  - [ ] 视频播放器组件
  - [ ] 上下滑动切换视频
  - [ ] 点赞/收藏按钮
  - [ ] 用户信息展示
  - [ ] 评论浮层

- [ ] **我的关注页面**
  - [ ] 关注用户列表
  - [ ] 关注用户的视频内容
  - [ ] 关注/取消关注功能

### 第三阶段：UI优化和交互完善
- [ ] **抖音风格UI实现**
  - [ ] 全屏视频播放
  - [ ] 右侧操作按钮组
  - [ ] 底部信息栏
  - [ ] 手势操作(滑动、双击等)
  - [ ] 动画效果

- [ ] **性能优化**
  - [ ] 视频预加载
  - [ ] 图片缓存
  - [ ] 内存管理
  - [ ] 网络优化

### 第四阶段：测试和发布准备
- [ ] 功能测试
- [ ] 性能测试
- [ ] 不同设备适配
- [ ] Android打包配置
- [ ] iOS打包配置(如需要)

## 核心功能模块设计

### 1. 认证模块 (Auth)
```
lib/
  features/
    auth/
      models/
        user_model.dart
      providers/
        auth_provider.dart
      screens/
        login_screen.dart
        register_screen.dart
      services/
        auth_service.dart
```

### 2. 首页推荐模块 (Home)
```
lib/
  features/
    home/
      models/
        video_model.dart
      providers/
        video_provider.dart
      screens/
        home_screen.dart
      widgets/
        video_player_widget.dart
        video_action_buttons.dart
```

### 3. 关注模块 (Following)
```
lib/
  features/
    following/
      models/
        follow_model.dart
      providers/
        following_provider.dart
      screens/
        following_screen.dart
```

## 技术选型和依赖

### 核心依赖
- `http` 或 `dio` - 网络请求
- `provider` 或 `riverpod` - 状态管理
- `go_router` - 路由管理
- `video_player` - 视频播放
- `cached_network_image` - 图片缓存
- `shared_preferences` - 本地存储

### UI组件
- `flutter_staggered_grid_view` - 瀑布流布局
- `pull_to_refresh` - 下拉刷新
- `flutter_spinkit` - 加载动画

### 开发工具
- `flutter_launcher_icons` - 应用图标
- `flutter_native_splash` - 启动页
- `json_annotation` - JSON序列化

## API集成规范

### 请求头配置
```dart
Map<String, String> headers = {
  'Content-Type': 'application/json',
  'Authorization': 'Bearer $token', // JWT Token
};
```

### 响应格式处理
```json
{
  "status": "SUCCESS|ERROR",
  "message": "响应消息",
  "data": {}, // 响应数据
  "pagination": {} // 分页信息(可选)
}
```

## 注意事项

1. **不修改后端**: 严格遵守不修改api和web目录的要求
2. **暂不实现个人中心**: 专注于推荐、关注、登录注册功能
3. **抖音风格**: 参考抖音的UI设计和交互方式
4. **性能优先**: 确保视频播放流畅，列表滚动顺滑
5. **网络处理**: 处理网络异常和错误状态
6. **用户体验**: 加载状态、错误提示、空状态设计

## 开发环境配置

### API地址配置
- 开发环境: `http://localhost:5200`
- 生产环境: `https://your-domain.com`

### 测试账号
- 邮箱: yoyo@love.com
- 密码: 111111

## 项目里程碑

- **里程碑1**: 项目初始化完成，能够运行基础框架
- **里程碑2**: 登录注册功能完成，能够获取token
- **里程碑3**: 推荐页面完成，能够显示视频列表
- **里程碑4**: 关注功能完成，能够查看关注的用户内容
- **里程碑5**: UI优化完成，达到可演示的效果

## 当前状态
- [x] 创建开发清单
- [x] 初始化Flutter项目
- [x] 实现登录/注册功能
- [x] 实现推荐页面
- [x] 实现我的关注页面

## 项目完成情况

### ✅ 已完成功能
1. **项目架构搭建**
   - Flutter项目初始化
   - 目录结构设计
   - 依赖配置

2. **认证系统**
   - 登录页面（邮箱+密码）
   - 注册页面（昵称+邮箱+密码）
   - JWT Token管理
   - 自动登录/登出

3. **推荐页面**
   - 抖音风格的视频列表
   - 垂直滑动切换
   - 视频播放器组件
   - 点赞/收藏/分享/评论按钮
   - 用户信息展示
   - 下拉刷新/上拉加载

4. **关注功能**
   - 关注用户列表
   - 关注用户的作品展示
   - 取消关注功能
   - 标签页切换

5. **基础组件**
   - 网络请求封装
   - 状态管理
   - 路由配置
   - 本地存储
   - 错误处理

### 🎯 演示功能
- 用户可以注册新账号或登录现有账号
- 首页显示推荐视频内容（连接后端API）
- 视频播放和交互功能
- 关注页面展示关注的用户和内容
- 完整的导航和页面跳转

### 📱 项目运行
项目已经可以运行，可以使用以下命令启动：
```bash
cd /Users/yanfang/dev/tama2/app
flutter pub get
flutter run
```

### 🔧 后续优化建议
1. 视频播放性能优化
2. 更多的UI动画效果
3. 完善错误处理和加载状态
4. 添加更多的用户交互功能
